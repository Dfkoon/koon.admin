import{i as R,b as w,j as e,s as A,p as g,u as S,q,e as z,f as d,a1 as E,d as N,r as u,B as t,T as o,I as x,C as L,l as T,A as $,o as B,t as y,z as v}from"./index-DiJP0-9s.js";import{d as G}from"./CheckCircle-C44imApy.js";import{d as H,a as k}from"./Refresh-DCOeZUIP.js";import{d as M}from"./Person-BavuKjIp.js";import{d as O}from"./AccessTime-HHnC3-Xg.js";import{G as b}from"./Grid-Cqdxh33Y.js";import{C as P}from"./Chip-BhGZD8wh.js";var f={},V=R;Object.defineProperty(f,"__esModule",{value:!0});var C=f.default=void 0,W=V(w()),Q=e;C=f.default=(0,W.default)((0,Q.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m2 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Assignment");const p="question_reports",m={async getAllReports(){try{const a=q(z(d,p),E("createdAt","desc"));return(await N(a)).docs.map(i=>({id:i.id,...i.data()}))}catch(a){return console.error("Error fetching question reports:",a),[]}},async updateStatus(a,n){const i=g(d,p,a);await S(i,{status:n,updatedAt:new Date})},async deleteReport(a){await A(g(d,p,a))}};function ee(){const[a,n]=u.useState([]),[i,h]=u.useState(!0),j=async()=>{h(!0);const s=await m.getAllReports();n(s),h(!1)};u.useEffect(()=>{j()},[]);const _=s=>{if(!s)return"بدون تاريخ";try{if(s.toDate)return s.toDate().toLocaleString("ar-EG");const r=new Date(s);return isNaN(r.getTime())?"تاريخ غير صالح":r.toLocaleString("ar-EG")}catch{return"خطأ في التاريخ"}},D=async(s,r)=>{await m.updateStatus(s,r),v.success("تم حل المشكلة"),n(l=>l.map(c=>c.id===s?{...c,status:r}:c))},I=async s=>{window.confirm("هل أنت متأكد من الحذف؟")&&(await m.deleteReport(s),v.success("تم الحذف"),n(r=>r.filter(l=>l.id!==s)))};return e.jsxs(t,{children:[e.jsxs(t,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(o,{variant:"h4",fontWeight:"bold",children:"مراجعة أسئلة الاختبارات"}),e.jsx(x,{color:"primary",onClick:j,className:"glass-panel",sx:{p:1.5},children:e.jsx(H,{})})]}),i?e.jsx(t,{display:"flex",justifyContent:"center",height:"50vh",alignItems:"center",children:e.jsx(L,{})}):a.length===0?e.jsxs(t,{sx:{textAlign:"center",mt:10,opacity:.5},children:[e.jsx(T,{sx:{fontSize:100,mb:2}}),e.jsx(o,{variant:"h6",children:"لا توجد تقارير حالياً"})]}):e.jsx(b,{container:!0,spacing:3,children:e.jsx($,{children:a.map((s,r)=>e.jsx(b,{item:!0,xs:12,md:6,children:e.jsx(B.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.05},children:e.jsxs(t,{className:"glass-panel",sx:{p:3,position:"relative"},children:[e.jsxs(t,{display:"flex",justifyContent:"space-between",mb:2,children:[e.jsxs(t,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(C,{color:"primary"}),e.jsxs(o,{variant:"subtitle1",fontWeight:"bold",children:["سؤال #",s.questionId||"غير معروف"]})]}),e.jsx(P,{label:s.status==="resolved"?"تم الحل":"قيد المراجعة",color:s.status==="resolved"?"success":"warning",size:"small"})]}),e.jsx(o,{variant:"body1",sx:{mb:2,bgcolor:"rgba(0,0,0,0.2)",p:2,borderRadius:2},children:s.comment||s.text||"لا يوجد تعليق"}),e.jsxs(t,{display:"flex",flexDirection:"column",gap:1,mb:2,children:[e.jsxs(t,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(M,{fontSize:"small",color:"disabled"}),e.jsxs(o,{variant:"caption",color:"text.secondary",children:["الطالب: ",s.studentName||"مجهول"," (",s.studentId||"N/A",")"]})]}),e.jsxs(t,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(O,{fontSize:"small",color:"disabled"}),e.jsxs(o,{variant:"caption",color:"text.secondary",children:["التاريخ: ",_(s.createdAt)]})]})]}),e.jsxs(t,{display:"flex",justifyContent:"flex-end",gap:1,pt:2,borderTop:"1px solid rgba(255,255,255,0.05)",children:[s.status!=="resolved"&&e.jsx(y,{title:"تم الحل",children:e.jsx(x,{color:"success",onClick:()=>D(s.id,"resolved"),children:e.jsx(G,{})})}),e.jsx(y,{title:"حذف",children:e.jsx(x,{color:"error",onClick:()=>I(s.id),children:e.jsx(k,{})})})]})]})})},s.id))})})]})}export{ee as default};
