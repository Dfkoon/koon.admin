import{M as S,L as C,r as p,N as L,_ as N,F as f,j as t,O,a as R,V as k,P as ae,ad as F,ae as se,D as re,aa as oe,ab as ne,W as I,i as Q,b as X,u as ie,p as E,s as le,a2 as ce,e as U,q as de,f as $,a1 as ue,d as pe,J as xe,B as x,T as g,o as q,a3 as w,K as fe,af as ge,I as G,C as me,A as ve,z as m}from"./index-DiJP0-9s.js";import{d as ye,a as Ce}from"./Refresh-DCOeZUIP.js";import{G as y}from"./Grid-Cqdxh33Y.js";import{F as he,S as be}from"./Switch-D4zRtLYl.js";function je(e){return S("MuiCard",e)}C("MuiCard",["root"]);const Ie=["className","raised"],$e=e=>{const{classes:s}=e;return k({root:["root"]},je,s)},we=O(ae,{name:"MuiCard",slot:"Root",overridesResolver:(e,s)=>s.root})(()=>({overflow:"hidden"})),Me=p.forwardRef(function(s,r){const o=L({props:s,name:"MuiCard"}),{className:n,raised:i=!1}=o,l=N(o,Ie),u=f({},o,{raised:i}),d=$e(u);return t.jsx(we,f({className:R(d.root,n),elevation:i?8:void 0,ref:r,ownerState:u},l))});function Be(e){return S("MuiCardContent",e)}C("MuiCardContent",["root"]);const Re=["className","component"],_e=e=>{const{classes:s}=e;return k({root:["root"]},Be,s)},Ae=O("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,s)=>s.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),De=p.forwardRef(function(s,r){const o=L({props:s,name:"MuiCardContent"}),{className:n,component:i="div"}=o,l=N(o,Re),u=f({},o,{component:i}),d=_e(u);return t.jsx(Ae,f({as:i,className:R(d.root,n),ownerState:u,ref:r},l))}),H=C("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),J=C("MuiListItemIcon",["root","alignItemsFlexStart"]),K=C("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function Se(e){return S("MuiMenuItem",e)}const b=C("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Le=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Ne=(e,s)=>{const{ownerState:r}=e;return[s.root,r.dense&&s.dense,r.divider&&s.divider,!r.disableGutters&&s.gutters]},Oe=e=>{const{disabled:s,dense:r,divider:o,disableGutters:n,selected:i,classes:l}=e,d=k({root:["root",r&&"dense",s&&"disabled",!n&&"gutters",o&&"divider",i&&"selected"]},Se,l);return f({},l,d)},ke=O(oe,{shouldForwardProp:e=>ne(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Ne})(({theme:e,ownerState:s})=>f({},e.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!s.disableGutters&&{paddingLeft:16,paddingRight:16},s.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${b.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:I(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${b.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:I(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${b.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:I(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:I(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${b.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${b.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${H.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${H.inset}`]:{marginLeft:52},[`& .${K.root}`]:{marginTop:0,marginBottom:0},[`& .${K.inset}`]:{paddingLeft:36},[`& .${J.root}`]:{minWidth:36}},!s.dense&&{[e.breakpoints.up("sm")]:{minHeight:"auto"}},s.dense&&f({minHeight:32,paddingTop:4,paddingBottom:4},e.typography.body2,{[`& .${J.root} svg`]:{fontSize:"1.25rem"}}))),j=p.forwardRef(function(s,r){const o=L({props:s,name:"MuiMenuItem"}),{autoFocus:n=!1,component:i="li",dense:l=!1,divider:u=!1,disableGutters:d=!1,focusVisibleClassName:_,role:a="menuitem",tabIndex:c,className:v}=o,h=N(o,Le),V=p.useContext(F),W=p.useMemo(()=>({dense:l||V.dense||!1,disableGutters:d}),[V.dense,l,d]),A=p.useRef(null);se(()=>{n&&A.current&&A.current.focus()},[n]);const ee=f({},o,{dense:W.dense,divider:u,disableGutters:d}),D=Oe(o),te=re(A,r);let z;return o.disabled||(z=c!==void 0?c:-1),t.jsx(F.Provider,{value:W,children:t.jsx(ke,f({ref:te,role:a,tabIndex:z,component:i,focusVisibleClassName:R(D.focusVisible,_),className:R(D.root,v)},h,{ownerState:ee,classes:D}))})});var P={},Pe=Q;Object.defineProperty(P,"__esModule",{value:!0});var Y=P.default=void 0,Te=Pe(X()),Ve=t;Y=P.default=(0,Te.default)((0,Ve.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");var T={},We=Q;Object.defineProperty(T,"__esModule",{value:!0});var Z=T.default=void 0,ze=We(X()),Fe=t;Z=T.default=(0,ze.default)((0,Fe.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History");const M="broadcasts",B={async getAllBroadcasts(){try{const e=de(U($,M),ue("createdAt","desc"));return(await pe(e)).docs.map(r=>{var o;return{id:r.id,...r.data(),createdAt:(o=r.data().createdAt)!=null&&o.toDate?r.data().createdAt.toDate():new Date(r.data().createdAt||Date.now())}})}catch(e){return console.error("Error fetching broadcasts:",e),[]}},async addBroadcast(e){return await ce(U($,M),{...e,createdAt:xe(),active:!0})},async deleteBroadcast(e){await le(E($,M,e))},async toggleActive(e,s){await ie(E($,M,e),{active:s})}};function He(){const[e,s]=p.useState([]),[r,o]=p.useState(!0),[n,i]=p.useState({title:"",message:"",type:"info",target:"all"}),l=async()=>{try{o(!0);const a=await B.getAllBroadcasts();s(Array.isArray(a)?a:[])}catch(a){console.error("Load broadcasts error:",a),s([])}finally{o(!1)}};p.useEffect(()=>{console.log("Broadcasts component mounted"),l()},[]);const u=async a=>{if(a.preventDefault(),!n.title||!n.message)return m.error("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");try{await B.addBroadcast(n),m.success("ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­ ðŸ“¢"),i({title:"",message:"",type:"info",target:"all"}),l()}catch{m.error("ÙØ´Ù„ ÙÙŠ Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†")}},d=async a=>{if(a&&window.confirm("Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù Ø³ÙŠØ®ØªÙÙŠ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ù† Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø·Ù„Ø§Ø¨ØŒ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ"))try{await B.deleteBroadcast(a),m.success("ØªÙ… Ø§Ù„Ø­Ø°Ù"),s(c=>c.filter(v=>v.id!==a))}catch{m.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù")}},_=async(a,c)=>{if(a)try{await B.toggleActive(a,c),m.success(c?"ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†":"ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†"),s(v=>v.map(h=>h.id===a?{...h,active:c}:h))}catch{m.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«")}};return t.jsxs(x,{children:[t.jsx(g,{variant:"h4",fontWeight:"bold",sx:{mb:4},children:"Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ø¬Ù„Ø© ðŸ“¢"}),t.jsxs(y,{container:!0,spacing:4,children:[t.jsx(y,{item:!0,xs:12,md:5,children:t.jsx(q.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:t.jsxs(x,{component:"form",onSubmit:u,className:"glass-panel",sx:{p:4},children:[t.jsxs(g,{variant:"h6",sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[t.jsx(Y,{color:"primary"})," Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯"]}),t.jsx(w,{fullWidth:!0,label:"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†",value:n.title,onChange:a=>i({...n,title:a.target.value}),sx:{mb:2}}),t.jsx(w,{fullWidth:!0,multiline:!0,rows:4,label:"Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†",value:n.message,onChange:a=>i({...n,message:a.target.value}),sx:{mb:2}}),t.jsxs(y,{container:!0,spacing:2,sx:{mb:3},children:[t.jsx(y,{item:!0,xs:6,children:t.jsxs(w,{select:!0,fullWidth:!0,label:"Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†",value:n.type,onChange:a=>i({...n,type:a.target.value}),children:[t.jsx(j,{value:"info",children:"Ù…Ø¹Ù„ÙˆÙ…Ø© (Ø£Ø²Ø±Ù‚)"}),t.jsx(j,{value:"warning",children:"ØªÙ†Ø¨ÙŠÙ‡ (Ø£ØµÙØ±)"}),t.jsx(j,{value:"urgent",children:"Ø¹Ø§Ø¬Ù„ (Ø£Ø­Ù…Ø±)"})]})}),t.jsx(y,{item:!0,xs:6,children:t.jsxs(w,{select:!0,fullWidth:!0,label:"Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù",value:n.target,onChange:a=>i({...n,target:a.target.value}),children:[t.jsx(j,{value:"all",children:"Ø§Ù„ÙƒÙ„"}),t.jsx(j,{value:"students",children:"Ø·Ù„Ø§Ø¨ Ù…Ø³Ø¬Ù„ÙŠÙ†"})]})})]}),t.jsx(fe,{type:"submit",variant:"contained",fullWidth:!0,size:"large",startIcon:t.jsx(ge,{}),sx:{py:1.5},children:"Ø¨Ø« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¢Ù†"})]})})}),t.jsxs(y,{item:!0,xs:12,md:7,children:[t.jsxs(x,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(g,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(Z,{})," Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª"]}),t.jsx(G,{onClick:l,children:t.jsx(ye,{})})]}),t.jsxs(x,{sx:{display:"flex",flexDirection:"column",gap:2},children:[r?t.jsx(x,{textAlign:"center",py:5,children:t.jsx(me,{})}):t.jsx(ve,{children:e&&e.map(a=>t.jsx(q.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},children:t.jsx(Me,{className:"glass-panel",sx:{background:"rgba(255,255,255,0.02)",borderLeft:`4px solid ${a.type==="urgent"?"#f44336":a.type==="warning"?"#ff9800":"#2196f3"}`},children:t.jsxs(De,{children:[t.jsxs(x,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1,children:[t.jsxs(x,{children:[t.jsx(g,{variant:"subtitle1",fontWeight:"bold",children:a.title}),t.jsxs(g,{variant:"caption",color:"text.secondary",children:[a.createdAt instanceof Date?a.createdAt.toLocaleString():"Ø§Ù„ØªØ§Ø±ÙŠØ® ØºÙŠØ± Ù…ØªÙˆÙØ±"," â€¢ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù: ",a.target==="all"?"Ø§Ù„ÙƒÙ„":"Ø§Ù„Ø·Ù„Ø§Ø¨"]})]}),t.jsxs(x,{display:"flex",alignItems:"center",children:[t.jsx(he,{control:t.jsx(be,{size:"small",checked:!!a.active,onChange:c=>_(a.id,c.target.checked)}),label:t.jsx(g,{variant:"caption",children:a.active?"Ù†Ø´Ø·":"Ù…ØªÙˆÙ‚Ù"})}),t.jsx(G,{color:"error",size:"small",onClick:()=>d(a.id),children:t.jsx(Ce,{fontSize:"small"})})]})]}),t.jsx(g,{variant:"body2",sx:{opacity:.8},children:a.message})]})})},a.id||Math.random()))}),!r&&(!e||e.length===0)&&t.jsx(x,{textAlign:"center",py:10,color:"text.secondary",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø³Ø§Ø¨Ù‚Ø©"})]})]})]})]})}export{He as default};
